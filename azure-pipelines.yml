trigger:
  - main

variables:
  jarName: 'demo-app-1.0-SNAPSHOT.jar'

stages:
  - stage: Build
    displayName: 'Build Stage'
    jobs:
      - job: BuildJob
        pool: default
        steps:
          - task: Maven@3
            inputs:
              mavenPomFile: 'pom.xml'
              goals: 'clean package'

          - script: |
              echo "âœ… Build complete. JAR file generated:"
              dir target
            displayName: 'List JAR file'

  - stage: Dev
    displayName: 'Deploy to Dev'
    dependsOn: Build
    jobs:
      - job: DevDeploy
        pool: default
        steps:
          - script: |
              echo "ðŸš€ Simulating deployment to Dev environment..."
              mkdir dev-deploy
              copy target\$(jarName) dev-deploy\
              dir dev-deploy
            displayName: 'Simulate Dev Deployment'

  - stage: Test
    displayName: 'Promote to Test (Staging)'
    dependsOn: Dev
    jobs:
      - job: TestDeploy
        pool: default
        steps:
          - script: |
              echo "ðŸš€ Simulating promotion to Test environment..."
              mkdir test-deploy
              copy dev-deploy\$(jarName) test-deploy\
              dir test-deploy
            displayName: 'Simulate Test Deployment'
