trigger:
  - main

variables:
  jarName: 'demo-app-1.0-SNAPSHOT.jar'
  jarPath: 'demo-app\\target'

stages:
  - stage: Build
    displayName: 'Build Stage'
    jobs:
      - job: BuildJob
        pool: default
        steps:
          - task: Maven@3
            inputs:
              mavenPomFile: 'demo-app/pom.xml'
              goals: 'clean package'

          - script: |
              echo âœ… Build complete. JAR file generated:
              dir demo-app\target
            displayName: 'List JAR file'

  - stage: Dev
    displayName: 'Deploy to Dev'
    dependsOn: Build
    jobs:
      - job: DevDeploy
        pool: default
        steps:
          - script: |
              echo ðŸš€ Simulating deployment to Dev environment...
              mkdir dev-deploy
              copy demo-app\target\demo-app-1.0-SNAPSHOT.jar dev-deploy\
              dir dev-deploy
            displayName: 'Simulate Dev Deployment'

  - stage: Test
    displayName: 'Promote to Test (Staging)'
    dependsOn: Dev
    jobs:
      - job: TestDeploy
        pool: default
        steps:
          - script: |
              echo ðŸš€ Simulating promotion to Test environment...
              mkdir test-deploy
              copy dev-deploy\demo-app-1.0-SNAPSHOT.jar test-deploy\
              dir test-deploy
            displayName: 'Simulate Test Deployment'
